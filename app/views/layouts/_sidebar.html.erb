<script>
  $(document).ready( function() {
    $( "#sidebar-tab" ).hide( "slide", { direction: "right" }, 250 );
    $( "#sidebar" ).hide( "slide", { direction: "right" }, 250 );
    $(".profile-toggle").click(function(e){
      $( "#sidebar-tab" ).css("visibility", "visible");
      $( "#sidebar" ).css("visibility", "visible");
      $( "#sidebar-tab" ).toggle( "slide", { direction: "right" }, 250 );
      $( "#sidebar" ).toggle( "slide", { direction: "right" }, 250 );
    });

    $('#profile_pic-div').hover(function (e) {
      $('#edit_avatar-link').css("visibility", "visible");
    }, function (e) {
      $('#edit_avatar-link').css("visibility", "hidden");
    });

    $("#upload_avatar-link").click(function (e) {
      $("#user_avatar").trigger('click');
    });

    $("#edit_avatar-link").click(function (e) {
      $("#user_avatar").trigger('click');
    });

    $("#user_avatar").on('change', function (e) {
      $(".edit_user").submit();
    });

    $('#new_journey-link').click(function (e) {
      window.location.href='journeys/new';
    });
  });
</script>

<% if(user_signed_in?) %>
  <div id="sidebar-toggle" class='profile-toggle'><p>Profile</p></div>
  <div id="sidebar-tab" class='profile-toggle'><p>Profile</p></div>
  <div id="sidebar">
    <p class="sidebar-nav">
      <br/>

      <% if current_user.avatar_file_name.nil? %>
        <%= form_for current_user, :url => registration_path(current_user),
          :html => { :method => :put } do |f| %>
          <p id="upload_avatar-link"> Upload Profile Picture</p>
          <%= f.file_field :avatar, style: "display:none" %>
        <% end %>
      <% else %>

        <div id='profile_pic-div' class='center'>
          <p id="edit_avatar-link"> Edit Pic</p>
          <%= form_for current_user, :url => registration_path(current_user),
            :html => { :method => :put } do |f| %>
            <%= f.file_field :avatar, style: "display:none" %>
            <%= image_tag current_user.avatar.url(:thumb), id: 'profile_pic' %>
          <% end %>
        </div>
      <% end %>

      <div id="username">
        <%= "#{current_user.first_name} #{current_user.last_name}" %>
      </div>
      <%= image_tag "journey_name_border.png", alt: "+", height: "4",
        width: "220", class: "journey_name_border" %>

      <div class="journey-list">

        <% current_user.journeys.each do |journey| %>
          <%= link_to journey.title, journey_path(journey),
            class: 'journey_name' %>
          <%= image_tag "journey_name_border.png", alt: "+", height: "4",
            width: "220", class: "journey_name_border" %>
        <% end %>

        <div id='new_journey-link'>
          <%= image_tag "circle_plus.png", alt: "+", height: "24", width: "24", id: 'create_new-img' %>
          <%= link_to "New Journey", new_journey_path, id: "new_journey-btn" %>
        </div>
        <%= image_tag "journey_name_border.png", alt: "+", height: "4",
          width: "220", class: "journey_name_border" %><br/>
      </div>

      <%= link_to "Account", edit_user_registration_path,
        id: "edit_account-btn" %>

    </p>
  </div>
<% end %>


